import{a as s,j as n,m as f,A as E}from"./framer-motion-DjJR-6Ks.js";const o=[{id:"first_visit",icon:"ðŸŒŸ",title:"FIRST CONNECT",desc:"åˆå›žã‚¢ã‚¯ã‚»ã‚¹",condition:()=>!0},{id:"scroll_bottom",icon:"ðŸ",title:"DEEP DIVER",desc:"ãƒšãƒ¼ã‚¸æœ€ä¸‹éƒ¨ã¾ã§åˆ°é”",condition:null},{id:"night_owl",icon:"ðŸ¦‰",title:"NIGHT OWL",desc:"æ·±å¤œã«ã‚¢ã‚¯ã‚»ã‚¹ (0-5æ™‚)",condition:()=>{const i=new Date().getHours();return i>=0&&i<5}},{id:"returner",icon:"ðŸ”„",title:"RETURNER",desc:"3å›žä»¥ä¸Šè¨ªå•",condition:()=>parseInt(localStorage.getItem("prokyi_visits")||"0")>=3},{id:"theme_switch",icon:"ðŸŽ¨",title:"STYLE HACKER",desc:"ãƒ†ãƒ¼ãƒžã‚’åˆ‡ã‚Šæ›¿ãˆãŸ",condition:null}];function g(){const[i,x]=s.useState(()=>{try{return JSON.parse(localStorage.getItem("prokyi_achievements")||"[]")}catch{return[]}}),[c,l]=s.useState(null),a=s.useRef(null),r=s.useRef([]),[d,p]=s.useState(!1),v=s.useRef(i),u=e=>{x(t=>t.includes(e)?t:[...t,e])};return s.useEffect(()=>{const e=v.current;v.current=i,localStorage.setItem("prokyi_achievements",JSON.stringify(i));const t=i.filter(m=>!e.includes(m));if(t.length>0){const m=t.map(h=>o.find(_=>_.id===h)).filter(Boolean);if(r.current.push(...m),!c&&r.current.length>0){const h=r.current.shift();l(h),clearTimeout(a.current),a.current=setTimeout(()=>l(null),3e3)}}},[i]),s.useEffect(()=>{const e=[];return o.forEach(t=>{t.condition&&t.condition()&&e.push(setTimeout(()=>u(t.id),2e3+Math.random()*1e3))}),()=>e.forEach(t=>clearTimeout(t))},[]),s.useEffect(()=>{let e=null;const t=()=>{e||(e=requestAnimationFrame(()=>{e=null,window.scrollY+window.innerHeight>=document.documentElement.scrollHeight-50&&u("scroll_bottom")}))};return window.addEventListener("scroll",t,{passive:!0}),()=>{window.removeEventListener("scroll",t),cancelAnimationFrame(e)}},[]),s.useEffect(()=>{const e=new MutationObserver(()=>{u("theme_switch")});return e.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>e.disconnect()},[]),s.useEffect(()=>{if(!c&&r.current.length>0){const e=r.current.shift(),t=setTimeout(()=>{l(e),a.current=setTimeout(()=>l(null),3e3)},400);return()=>clearTimeout(t)}},[c]),s.useEffect(()=>{if(!d)return;const e=t=>{t.key==="Escape"&&p(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[d]),s.useEffect(()=>()=>clearTimeout(a.current),[]),n.jsxs(n.Fragment,{children:[n.jsxs(f.button,{className:"achievement-btn",onClick:()=>p(e=>!e),whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":`å®Ÿç¸¾ (${i.length}/${o.length})`,title:`${i.length}/${o.length} Achievements`,children:["ðŸ†",i.length>0&&n.jsx("span",{className:"achievement-btn__count",children:i.length})]}),n.jsx(E,{children:c&&n.jsxs(f.div,{className:"achievement-toast",initial:{x:100,opacity:0},animate:{x:0,opacity:1},exit:{x:100,opacity:0},transition:{type:"spring",stiffness:300,damping:25},children:[n.jsx("span",{className:"achievement-toast__icon",children:c.icon}),n.jsxs("div",{children:[n.jsx("p",{className:"achievement-toast__title",children:"ACHIEVEMENT UNLOCKED"}),n.jsx("p",{className:"achievement-toast__name",children:c.title})]})]})}),n.jsx(E,{children:d&&n.jsxs(f.div,{className:"achievement-panel",initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.25},children:[n.jsxs("div",{className:"achievement-panel__header",children:[n.jsx("span",{children:"ðŸ† ACHIEVEMENTS"}),n.jsxs("span",{className:"achievement-panel__progress",children:[i.length,"/",o.length]})]}),n.jsx("div",{className:"achievement-panel__list",children:o.map(e=>{const t=i.includes(e.id);return n.jsxs("div",{className:`achievement-item ${t?"achievement-item--unlocked":""}`,children:[n.jsx("span",{className:"achievement-item__icon",children:t?e.icon:"ðŸ”’"}),n.jsxs("div",{children:[n.jsx("p",{className:"achievement-item__title",children:t?e.title:"???"}),n.jsx("p",{className:"achievement-item__desc",children:t?e.desc:"æœªè§£æ”¾"})]})]},e.id)})})]})})]})}const w=s.memo(g);export{w as default};
