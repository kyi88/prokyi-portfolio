import{a as t,j as e,m as x,A as H}from"./framer-motion-DjJR-6Ks.js";import{S as se,a as ae}from"./index-CeMzKxFQ.js";import"./three-Q1KPoeDW.js";const ne=["ü•õ","‚òï","ü•õ","‚òï"],re=["üçé","üçô","üíß","üçµ","üç∞"],ce=15,U=i=>i[Math.floor(Math.random()*i.length)];function ie({onClose:i}){const[c,o]=t.useState(0),[a,f]=t.useState(3),[m,v]=t.useState(ce),[_,p]=t.useState([]),[l,u]=t.useState(!1),[n,w]=t.useState(0),[T,A]=t.useState([]),$=t.useRef(0);t.useEffect(()=>{if(l)return;const s=setInterval(()=>{const r=Math.random()<.4;p(d=>[...d.slice(-14),{id:$.current++,emoji:U(r?ne:re),hazard:r,x:8+Math.random()*84,y:-8,speed:1.2+Math.random()*2.2}])},550);return()=>clearInterval(s)},[l]),t.useEffect(()=>{if(l)return;const s=setInterval(()=>{let r=[];p(d=>{const y=[];for(const g of d){const N=g.y+g.speed;N>=100?g.hazard&&r.push(g.x):y.push({...g,y:N})}return y});for(const d of r)f(y=>y-1),R(d,"üíÄ");r=[]},50);return()=>clearInterval(s)},[l]),t.useEffect(()=>{if(l)return;const s=setInterval(()=>v(r=>r<=1?(u(!0),0):r-1),1e3);return()=>clearInterval(s)},[l]),t.useEffect(()=>{a<=0&&u(!0)},[a]);const S=t.useRef(new Set);t.useEffect(()=>()=>{S.current.forEach(s=>clearTimeout(s)),S.current.clear()},[]);const R=(s,r)=>{const d=Date.now()+Math.random();A(g=>[...g,{id:d,x:s,text:r}]);const y=setTimeout(()=>{A(g=>g.filter(N=>N.id!==d)),S.current.delete(y)},600);S.current.add(y)},F=t.useCallback(s=>{if(!l)if(p(r=>r.filter(d=>d.id!==s.id)),s.hazard){const r=10+n*5;o(d=>d+r),w(d=>d+1),R(s.x,`+${r}`)}else o(r=>r+5),R(s.x,"+5")},[l,n]);return e.jsx(x.div,{className:"sg-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},role:"dialog","aria-modal":"true","aria-label":"ËÖπÁóõÂõûÈÅø„Éü„Éã„Ç≤„Éº„É†",children:e.jsxs("div",{className:"sg",children:[e.jsxs("div",{className:"sg__head",children:[e.jsx("h3",{className:"sg__title",children:"üö® STOMACH DEFENSE üö®"}),e.jsxs("p",{className:"sg__rules",children:["ü•õ‚òï„Çí",e.jsx("strong",{children:"„Çø„ÉÉ„Éó„Åó„Å¶ÂõûÈÅø"}),"ÔºÅÂÆâÂÖ®„Å™È£ü„ÅπÁâ©üçé„Çí",e.jsx("strong",{children:"„Çø„ÉÉ„Éó„ÅßÊëÇÂèñ"}),"ÔºÅ"]})]}),e.jsxs("div",{className:"sg__hud",children:[e.jsx("span",{children:"‚ù§Ô∏è".repeat(Math.max(a,0))}),e.jsxs("span",{children:["‚è± ",m,"s"]}),e.jsxs("span",{children:["üèÜ ",c]}),n>1&&e.jsxs(x.span,{className:"sg__combo",initial:{scale:1.5},animate:{scale:1},children:["üî•x",n]},n)]}),e.jsxs("div",{className:"sg__field",children:[_.map(s=>e.jsx("button",{className:`sg__item${s.hazard?" sg__item--haz":""}`,style:{left:`${s.x}%`,top:`${s.y}%`},onClick:()=>F(s),children:s.emoji},s.id)),e.jsx(H,{children:T.map(s=>e.jsx(x.span,{className:"sg__flash",style:{left:`${s.x}%`},initial:{opacity:1,y:0},animate:{opacity:0,y:-30},exit:{opacity:0},transition:{duration:.5},children:s.text},s.id))}),e.jsx("div",{className:"sg__danger","aria-hidden":"true"})]}),l&&e.jsxs(x.div,{className:"sg__result",initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},children:[e.jsx("h4",{children:a<=0?"üíÄ STOMACH DESTROYED":"üéâ SURVIVED!"}),e.jsxs("p",{className:"sg__rscore",children:["SCORE: ",c]}),e.jsx("button",{className:"sg__rbtn",onClick:i,children:"CLOSE"})]}),e.jsx("button",{className:"sg__x",onClick:i,"aria-label":"Èñâ„Åò„Çã",children:"‚úï"})]})})}let D=null;function le(){return D||(D=new(window.AudioContext||window.webkitAudioContext)),D.state==="suspended"&&D.resume(),D}const b=(i,c=.04,o=.04)=>{try{const a=le(),f=a.createOscillator(),m=a.createGain();f.type="square",f.frequency.value=i,m.gain.value=o,f.connect(m),m.connect(a.destination),f.start(),m.gain.exponentialRampToValueAtTime(.001,a.currentTime+c),f.stop(a.currentTime+c+.01)}catch{}},L={key:()=>b(800+Math.random()*200,.02,.02),ok:()=>b(1200,.06,.04),miss:()=>b(200,.08,.04),start:()=>{b(600,.05),setTimeout(()=>b(900,.05),60)},done:()=>{b(800,.06),setTimeout(()=>b(1e3,.06),80),setTimeout(()=>b(1300,.08),160)}},V=["cyberdeck","neural","proxy","encrypt","kernel","daemon","socket","buffer","malloc","thread","docker","deploy","branch","commit","rebase","pipeline","lambda","vector","matrix","binary","quantum","async","await","class","import","render","state","props","react","vite"],K=20;function Y(i){const c=[...i];for(let o=c.length-1;o>0;o--){const a=Math.floor(Math.random()*(o+1));[c[o],c[a]]=[c[a],c[o]]}return c}function oe({onClose:i}){const{muted:c}=t.useContext(se),o=t.useRef(c);o.current=c;const[a,f]=t.useState("ready"),[m,v]=t.useState([]),[_,p]=t.useState(0),[l,u]=t.useState(""),[n,w]=t.useState(0),[T,A]=t.useState(0),[$,S]=t.useState(0),[R,F]=t.useState(0),[s,r]=t.useState(K),[d,y]=t.useState(0),[g,N]=t.useState(null),[k,X]=t.useState(()=>parseInt(localStorage.getItem("prokyi_typing_best")||"0",10)),[W,z]=t.useState(!1),P=t.useRef(null),M=t.useRef(null);t.useEffect(()=>()=>clearTimeout(M.current),[]);const I=t.useCallback(h=>{o.current||h()},[]),B=t.useCallback(()=>{v(Y(V)),p(0),u(""),w(0),A(0),S(0),F(0),r(K),y(0),z(!1),f("playing"),I(L.start)},[]);t.useEffect(()=>{if(a!=="playing")return;if(s<=0){f("done"),I(L.done);return}const h=setTimeout(()=>r(j=>j-1),1e3);return()=>clearTimeout(h)},[a,s]),t.useEffect(()=>{a==="playing"&&P.current&&P.current.focus()},[a]);const O=m[_]||"",Z=h=>{const j=h.target.value;if(u(j),j===O){const E=O.length*(1+$*.2);w(C=>C+Math.round(E)),A(C=>C+O.length),S(C=>{const G=C+1;return F(te=>Math.max(te,G)),G}),N("correct"),I(L.ok),clearTimeout(M.current),M.current=setTimeout(()=>N(null),300),u(""),_+1>=m.length?(v(Y(V)),p(0)):p(C=>C+1)}else O.startsWith(j)?I(L.key):(y(E=>E+1),S(0),N("miss"),I(L.miss),clearTimeout(M.current),M.current=setTimeout(()=>N(null),200))},J=()=>O.split("").map((h,j)=>{let E="tg-char";return j<l.length?E+=l[j]===h?" tg-char--ok":" tg-char--err":j===l.length&&(E+=" tg-char--cursor"),e.jsx("span",{className:E,children:h},j)}),Q=K-s,ee=a==="done"?Math.round(T/5/(Math.max(Q,1)/60)):0;return t.useEffect(()=>{a==="done"&&n>k&&(X(n),z(!0),localStorage.setItem("prokyi_typing_best",String(n)))},[a,n,k]),e.jsx(x.div,{className:"tg-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:h=>h.target===h.currentTarget&&i(),children:e.jsxs(x.div,{className:"tg-panel",initial:{scale:.8,y:40},animate:{scale:1,y:0},exit:{scale:.8,y:40},children:[e.jsx("button",{className:"tg-close",onClick:i,"aria-label":"Èñâ„Åò„Çã",children:"‚úï"}),e.jsxs("h2",{className:"tg-title",children:[e.jsx("span",{className:"tg-title__icon",children:"‚å®Ô∏è"})," HACK_TYPING"]}),a==="ready"&&e.jsxs(x.div,{className:"tg-ready",initial:{opacity:0},animate:{opacity:1},children:[e.jsxs("p",{className:"tg-ready__desc",children:["Ë°®Á§∫„Åï„Çå„ÇãÂçòË™û„Çí„Åß„Åç„Çã„Å†„ÅëÈÄü„Åè„Çø„Ç§„Éó„Åõ„Çà„ÄÇ",e.jsx("br",{}),"Âà∂ÈôêÊôÇÈñì ",e.jsxs("strong",{children:[K,"Áßí"]}),"„ÄÇ„Ç≥„É≥„Éú„Åß„Çπ„Ç≥„Ç¢ÂÄçÁéáUP„ÄÇ"]}),k>0&&e.jsxs("p",{className:"tg-ready__best",children:["üèÜ BEST: ",k]}),e.jsx("button",{className:"tg-start-btn",onClick:B,children:"> START HACK_"})]}),a==="playing"&&e.jsxs("div",{className:`tg-game ${g==="correct"?"tg-game--flash-ok":""} ${g==="miss"?"tg-game--flash-err":""}`,children:[e.jsxs("div",{className:"tg-hud",children:[e.jsxs("div",{className:"tg-hud__item",children:[e.jsx("span",{className:"tg-hud__label",children:"TIME"}),e.jsx("span",{className:`tg-hud__val ${s<=5?"tg-hud__val--danger":""}`,children:s})]}),e.jsxs("div",{className:"tg-hud__item",children:[e.jsx("span",{className:"tg-hud__label",children:"SCORE"}),e.jsx("span",{className:"tg-hud__val",children:n})]}),e.jsxs("div",{className:"tg-hud__item",children:[e.jsx("span",{className:"tg-hud__label",children:"COMBO"}),e.jsxs("span",{className:"tg-hud__val tg-hud__val--combo",children:["√ó",$]})]})]}),e.jsx("div",{className:"tg-time-bar",children:e.jsx(x.div,{className:"tg-time-bar__fill",animate:{width:`${s/K*100}%`},transition:{duration:.3}})}),e.jsx("div",{className:"tg-word",children:J()}),e.jsx("input",{ref:P,className:"tg-input",value:l,onChange:Z,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",placeholder:"type here..."}),e.jsx("div",{className:"tg-next",children:m.slice(_+1,_+4).map((h,j)=>e.jsx("span",{className:"tg-next__word",children:h},j))})]}),a==="done"&&e.jsxs(x.div,{className:"tg-result",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},children:[e.jsx("p",{className:"tg-result__title",children:"HACK COMPLETE"}),e.jsxs("div",{className:"tg-result__stats",children:[e.jsxs("div",{children:[e.jsx("span",{children:"SCORE"}),e.jsx("strong",{children:n})]}),e.jsxs("div",{children:[e.jsx("span",{children:"MAX COMBO"}),e.jsxs("strong",{children:["√ó",R]})]}),e.jsxs("div",{children:[e.jsx("span",{children:"MISTAKES"}),e.jsx("strong",{children:d})]}),e.jsxs("div",{children:[e.jsx("span",{children:"SPEED"}),e.jsxs("strong",{children:["~",ee," WPM"]})]})]}),e.jsx("div",{className:"tg-result__grade",children:n>=200?"üèÜ S RANK":n>=120?"ü•á A RANK":n>=60?"ü•à B RANK":"ü•â C RANK"}),W&&e.jsx(x.p,{className:"tg-result__new-record",initial:{scale:0,rotate:-10},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:300,damping:15,delay:.3},children:"‚ö° NEW RECORD! ‚ö°"}),k>0&&!W&&e.jsxs("p",{className:"tg-result__best-ref",children:["BEST: ",k]}),e.jsxs("div",{className:"tg-result__actions",children:[e.jsx("button",{className:"tg-start-btn",onClick:B,children:"> RETRY_"}),e.jsx("button",{className:"tg-start-btn tg-start-btn--ghost",onClick:i,children:"> EXIT_"})]})]})]})})}const q=["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight","b","a"];function he(){const[i,c]=t.useState(!1),[o,a]=t.useState(null),[f,m]=t.useState(!1),[v,_]=t.useState(0),p=t.useRef(null),{play:l}=ae("click");return t.useEffect(()=>{const u=n=>{if((n.key.length===1?n.key.toLowerCase():n.key)===q[v]){const T=v+1;T===q.length?(m(!0),_(0),document.documentElement.classList.add("retro-mode"),clearTimeout(p.current),p.current=setTimeout(()=>{document.documentElement.classList.remove("retro-mode"),m(!1)},5e3)):_(T)}else _(0)};return window.addEventListener("keydown",u),()=>{window.removeEventListener("keydown",u),clearTimeout(p.current)}},[v]),t.useEffect(()=>{if(!i)return;const u=n=>{!n.target.closest(".ee-fab")&&!n.target.closest(".ee-menu")&&c(!1)};return document.addEventListener("pointerdown",u),()=>document.removeEventListener("pointerdown",u)},[i]),t.useEffect(()=>()=>{clearTimeout(p.current),document.documentElement.classList.remove("retro-mode")},[]),e.jsxs(e.Fragment,{children:[e.jsx(x.button,{className:"ee-fab",onClick:()=>{l(),c(u=>!u)},whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":"„Ç§„Éº„Çπ„Çø„Éº„Ç®„ÉÉ„Ç∞„É°„Éã„É•„Éº","aria-expanded":i,children:"üéÆ"}),e.jsx(H,{children:i&&e.jsxs(x.div,{className:"ee-menu",role:"menu",initial:{opacity:0,y:16,scale:.85},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:16,scale:.85},children:[e.jsx("button",{className:"ee-menu__btn",role:"menuitem",onClick:()=>{l(),a("stomach"),c(!1)},children:"üö® STOMACH DEFENSE"}),e.jsx("button",{className:"ee-menu__btn",role:"menuitem",onClick:()=>{l(),a("typing"),c(!1)},children:"‚å®Ô∏è HACK_TYPING"})]})}),e.jsx(H,{children:o==="stomach"&&e.jsx(ie,{onClose:()=>a(null)})}),e.jsx(H,{children:o==="typing"&&e.jsx(oe,{onClose:()=>a(null)})}),e.jsx(H,{children:f&&e.jsxs(x.div,{className:"konami-flash",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},"aria-live":"polite",children:[e.jsx("span",{className:"konami-flash__text",children:"‚¨ÜÔ∏è‚¨ÜÔ∏è‚¨áÔ∏è‚¨áÔ∏è‚¨ÖÔ∏è‚û°Ô∏è‚¨ÖÔ∏è‚û°Ô∏èüÖ±Ô∏èüÖ∞Ô∏è"}),e.jsx("span",{className:"konami-flash__sub",children:"RETRO MODE ACTIVATED"})]})})]})}export{he as default};
