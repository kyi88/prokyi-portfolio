import{a as t,j as e,m as x,A as K}from"./framer-motion-DjJR-6Ks.js";import{S as se}from"./index-DY-FJu7u.js";import"./three-Q1KPoeDW.js";const ae=["ü•õ","‚òï","ü•õ","‚òï"],ne=["üçé","üçô","üíß","üçµ","üç∞"],re=15,U=i=>i[Math.floor(Math.random()*i.length)];function ce({onClose:i}){const[c,l]=t.useState(0),[a,f]=t.useState(3),[u,v]=t.useState(re),[_,j]=t.useState([]),[n,m]=t.useState(!1),[o,E]=t.useState(0),[F,w]=t.useState([]),H=t.useRef(0);t.useEffect(()=>{if(n)return;const s=setInterval(()=>{const r=Math.random()<.4;j(d=>[...d.slice(-14),{id:H.current++,emoji:U(r?ae:ne),hazard:r,x:8+Math.random()*84,y:-8,speed:1.2+Math.random()*2.2}])},550);return()=>clearInterval(s)},[n]),t.useEffect(()=>{if(n)return;const s=setInterval(()=>{let r=[];j(d=>{const y=[];for(const p of d){const N=p.y+p.speed;N>=100?p.hazard&&r.push(p.x):y.push({...p,y:N})}return y});for(const d of r)f(y=>y-1),A(d,"üíÄ");r=[]},50);return()=>clearInterval(s)},[n]),t.useEffect(()=>{if(n)return;const s=setInterval(()=>v(r=>r<=1?(m(!0),0):r-1),1e3);return()=>clearInterval(s)},[n]),t.useEffect(()=>{a<=0&&m(!0)},[a]);const S=t.useRef(new Set);t.useEffect(()=>()=>{S.current.forEach(s=>clearTimeout(s)),S.current.clear()},[]);const A=(s,r)=>{const d=Date.now()+Math.random();w(p=>[...p,{id:d,x:s,text:r}]);const y=setTimeout(()=>{w(p=>p.filter(N=>N.id!==d)),S.current.delete(y)},600);S.current.add(y)},$=t.useCallback(s=>{if(!n)if(j(r=>r.filter(d=>d.id!==s.id)),s.hazard){const r=10+o*5;l(d=>d+r),E(d=>d+1),A(s.x,`+${r}`)}else l(r=>r+5),A(s.x,"+5")},[n,o]);return e.jsx(x.div,{className:"sg-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},role:"dialog","aria-modal":"true","aria-label":"ËÖπÁóõÂõûÈÅø„Éü„Éã„Ç≤„Éº„É†",children:e.jsxs("div",{className:"sg",children:[e.jsxs("div",{className:"sg__head",children:[e.jsx("h3",{className:"sg__title",children:"üö® STOMACH DEFENSE üö®"}),e.jsxs("p",{className:"sg__rules",children:["ü•õ‚òï„Çí",e.jsx("strong",{children:"„Çø„ÉÉ„Éó„Åó„Å¶ÂõûÈÅø"}),"ÔºÅÂÆâÂÖ®„Å™È£ü„ÅπÁâ©üçé„Çí",e.jsx("strong",{children:"„Çø„ÉÉ„Éó„ÅßÊëÇÂèñ"}),"ÔºÅ"]})]}),e.jsxs("div",{className:"sg__hud",children:[e.jsx("span",{children:"‚ù§Ô∏è".repeat(Math.max(a,0))}),e.jsxs("span",{children:["‚è± ",u,"s"]}),e.jsxs("span",{children:["üèÜ ",c]}),o>1&&e.jsxs(x.span,{className:"sg__combo",initial:{scale:1.5},animate:{scale:1},children:["üî•x",o]},o)]}),e.jsxs("div",{className:"sg__field",children:[_.map(s=>e.jsx("button",{className:`sg__item${s.hazard?" sg__item--haz":""}`,style:{left:`${s.x}%`,top:`${s.y}%`},onClick:()=>$(s),children:s.emoji},s.id)),e.jsx(K,{children:F.map(s=>e.jsx(x.span,{className:"sg__flash",style:{left:`${s.x}%`},initial:{opacity:1,y:0},animate:{opacity:0,y:-30},exit:{opacity:0},transition:{duration:.5},children:s.text},s.id))}),e.jsx("div",{className:"sg__danger","aria-hidden":"true"})]}),n&&e.jsxs(x.div,{className:"sg__result",initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},children:[e.jsx("h4",{children:a<=0?"üíÄ STOMACH DESTROYED":"üéâ SURVIVED!"}),e.jsxs("p",{className:"sg__rscore",children:["SCORE: ",c]}),e.jsx("button",{className:"sg__rbtn",onClick:i,children:"CLOSE"})]}),e.jsx("button",{className:"sg__x",onClick:i,"aria-label":"Èñâ„Åò„Çã",children:"‚úï"})]})})}let O=null;function ie(){return O||(O=new(window.AudioContext||window.webkitAudioContext)),O.state==="suspended"&&O.resume(),O}const b=(i,c=.04,l=.04)=>{try{const a=ie(),f=a.createOscillator(),u=a.createGain();f.type="square",f.frequency.value=i,u.gain.value=l,f.connect(u),u.connect(a.destination),f.start(),u.gain.exponentialRampToValueAtTime(.001,a.currentTime+c),f.stop(a.currentTime+c+.01)}catch{}},D={key:()=>b(800+Math.random()*200,.02,.02),ok:()=>b(1200,.06,.04),miss:()=>b(200,.08,.04),start:()=>{b(600,.05),setTimeout(()=>b(900,.05),60)},done:()=>{b(800,.06),setTimeout(()=>b(1e3,.06),80),setTimeout(()=>b(1300,.08),160)}},V=["cyberdeck","neural","proxy","encrypt","kernel","daemon","socket","buffer","malloc","thread","docker","deploy","branch","commit","rebase","pipeline","lambda","vector","matrix","binary","quantum","async","await","class","import","render","state","props","react","vite"],L=20;function Y(i){const c=[...i];for(let l=c.length-1;l>0;l--){const a=Math.floor(Math.random()*(l+1));[c[l],c[a]]=[c[a],c[l]]}return c}function le({onClose:i}){const{muted:c}=t.useContext(se),l=t.useRef(c);l.current=c;const[a,f]=t.useState("ready"),[u,v]=t.useState([]),[_,j]=t.useState(0),[n,m]=t.useState(""),[o,E]=t.useState(0),[F,w]=t.useState(0),[H,S]=t.useState(0),[A,$]=t.useState(0),[s,r]=t.useState(L),[d,y]=t.useState(0),[p,N]=t.useState(null),[k,X]=t.useState(()=>parseInt(localStorage.getItem("prokyi_typing_best")||"0",10)),[W,z]=t.useState(!1),P=t.useRef(null),R=t.useRef(null);t.useEffect(()=>()=>clearTimeout(R.current),[]);const M=t.useCallback(h=>{l.current||h()},[]),B=t.useCallback(()=>{v(Y(V)),j(0),m(""),E(0),w(0),S(0),$(0),r(L),y(0),z(!1),f("playing"),M(D.start)},[]);t.useEffect(()=>{if(a!=="playing")return;if(s<=0){f("done"),M(D.done);return}const h=setTimeout(()=>r(g=>g-1),1e3);return()=>clearTimeout(h)},[a,s]),t.useEffect(()=>{a==="playing"&&P.current&&P.current.focus()},[a]);const I=u[_]||"",Z=h=>{const g=h.target.value;if(m(g),g===I){const C=I.length*(1+H*.2);E(T=>T+Math.round(C)),w(T=>T+I.length),S(T=>{const G=T+1;return $(te=>Math.max(te,G)),G}),N("correct"),M(D.ok),clearTimeout(R.current),R.current=setTimeout(()=>N(null),300),m(""),_+1>=u.length?(v(Y(V)),j(0)):j(T=>T+1)}else I.startsWith(g)?M(D.key):(y(C=>C+1),S(0),N("miss"),M(D.miss),clearTimeout(R.current),R.current=setTimeout(()=>N(null),200))},J=()=>I.split("").map((h,g)=>{let C="tg-char";return g<n.length?C+=n[g]===h?" tg-char--ok":" tg-char--err":g===n.length&&(C+=" tg-char--cursor"),e.jsx("span",{className:C,children:h},g)}),Q=L-s,ee=a==="done"?Math.round(F/5/(Math.max(Q,1)/60)):0;return t.useEffect(()=>{a==="done"&&o>k&&(X(o),z(!0),localStorage.setItem("prokyi_typing_best",String(o)))},[a,o,k]),e.jsx(x.div,{className:"tg-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:h=>h.target===h.currentTarget&&i(),children:e.jsxs(x.div,{className:"tg-panel",initial:{scale:.8,y:40},animate:{scale:1,y:0},exit:{scale:.8,y:40},children:[e.jsx("button",{className:"tg-close",onClick:i,"aria-label":"Èñâ„Åò„Çã",children:"‚úï"}),e.jsxs("h2",{className:"tg-title",children:[e.jsx("span",{className:"tg-title__icon",children:"‚å®Ô∏è"})," HACK_TYPING"]}),a==="ready"&&e.jsxs(x.div,{className:"tg-ready",initial:{opacity:0},animate:{opacity:1},children:[e.jsxs("p",{className:"tg-ready__desc",children:["Ë°®Á§∫„Åï„Çå„ÇãÂçòË™û„Çí„Åß„Åç„Çã„Å†„ÅëÈÄü„Åè„Çø„Ç§„Éó„Åõ„Çà„ÄÇ",e.jsx("br",{}),"Âà∂ÈôêÊôÇÈñì ",e.jsxs("strong",{children:[L,"Áßí"]}),"„ÄÇ„Ç≥„É≥„Éú„Åß„Çπ„Ç≥„Ç¢ÂÄçÁéáUP„ÄÇ"]}),k>0&&e.jsxs("p",{className:"tg-ready__best",children:["üèÜ BEST: ",k]}),e.jsx("button",{className:"tg-start-btn",onClick:B,children:"> START HACK_"})]}),a==="playing"&&e.jsxs("div",{className:`tg-game ${p==="correct"?"tg-game--flash-ok":""} ${p==="miss"?"tg-game--flash-err":""}`,children:[e.jsxs("div",{className:"tg-hud",children:[e.jsxs("div",{className:"tg-hud__item",children:[e.jsx("span",{className:"tg-hud__label",children:"TIME"}),e.jsx("span",{className:`tg-hud__val ${s<=5?"tg-hud__val--danger":""}`,children:s})]}),e.jsxs("div",{className:"tg-hud__item",children:[e.jsx("span",{className:"tg-hud__label",children:"SCORE"}),e.jsx("span",{className:"tg-hud__val",children:o})]}),e.jsxs("div",{className:"tg-hud__item",children:[e.jsx("span",{className:"tg-hud__label",children:"COMBO"}),e.jsxs("span",{className:"tg-hud__val tg-hud__val--combo",children:["√ó",H]})]})]}),e.jsx("div",{className:"tg-time-bar",children:e.jsx(x.div,{className:"tg-time-bar__fill",animate:{width:`${s/L*100}%`},transition:{duration:.3}})}),e.jsx("div",{className:"tg-word",children:J()}),e.jsx("input",{ref:P,className:"tg-input",value:n,onChange:Z,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",placeholder:"type here..."}),e.jsx("div",{className:"tg-next",children:u.slice(_+1,_+4).map((h,g)=>e.jsx("span",{className:"tg-next__word",children:h},g))})]}),a==="done"&&e.jsxs(x.div,{className:"tg-result",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},children:[e.jsx("p",{className:"tg-result__title",children:"HACK COMPLETE"}),e.jsxs("div",{className:"tg-result__stats",children:[e.jsxs("div",{children:[e.jsx("span",{children:"SCORE"}),e.jsx("strong",{children:o})]}),e.jsxs("div",{children:[e.jsx("span",{children:"MAX COMBO"}),e.jsxs("strong",{children:["√ó",A]})]}),e.jsxs("div",{children:[e.jsx("span",{children:"MISTAKES"}),e.jsx("strong",{children:d})]}),e.jsxs("div",{children:[e.jsx("span",{children:"SPEED"}),e.jsxs("strong",{children:["~",ee," WPM"]})]})]}),e.jsx("div",{className:"tg-result__grade",children:o>=200?"üèÜ S RANK":o>=120?"ü•á A RANK":o>=60?"ü•à B RANK":"ü•â C RANK"}),W&&e.jsx(x.p,{className:"tg-result__new-record",initial:{scale:0,rotate:-10},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:300,damping:15,delay:.3},children:"‚ö° NEW RECORD! ‚ö°"}),k>0&&!W&&e.jsxs("p",{className:"tg-result__best-ref",children:["BEST: ",k]}),e.jsxs("div",{className:"tg-result__actions",children:[e.jsx("button",{className:"tg-start-btn",onClick:B,children:"> RETRY_"}),e.jsx("button",{className:"tg-start-btn tg-start-btn--ghost",onClick:i,children:"> EXIT_"})]})]})]})})}const q=["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight","b","a"];function me(){const[i,c]=t.useState(!1),[l,a]=t.useState(null),[f,u]=t.useState(!1),[v,_]=t.useState(0),j=t.useRef(null);return t.useEffect(()=>{const n=m=>{if((m.key.length===1?m.key.toLowerCase():m.key)===q[v]){const E=v+1;E===q.length?(u(!0),_(0),document.documentElement.classList.add("retro-mode"),clearTimeout(j.current),j.current=setTimeout(()=>{document.documentElement.classList.remove("retro-mode"),u(!1)},5e3)):_(E)}else _(0)};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[v]),t.useEffect(()=>{if(!i)return;const n=m=>{!m.target.closest(".ee-fab")&&!m.target.closest(".ee-menu")&&c(!1)};return document.addEventListener("pointerdown",n),()=>document.removeEventListener("pointerdown",n)},[i]),t.useEffect(()=>()=>{clearTimeout(j.current),document.documentElement.classList.remove("retro-mode")},[]),e.jsxs(e.Fragment,{children:[e.jsx(x.button,{className:"ee-fab",onClick:()=>c(n=>!n),whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":"„Ç§„Éº„Çπ„Çø„Éº„Ç®„ÉÉ„Ç∞„É°„Éã„É•„Éº","aria-expanded":i,children:"üéÆ"}),e.jsx(K,{children:i&&e.jsxs(x.div,{className:"ee-menu",role:"menu",initial:{opacity:0,y:16,scale:.85},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:16,scale:.85},children:[e.jsx("button",{className:"ee-menu__btn",role:"menuitem",onClick:()=>{a("stomach"),c(!1)},children:"üö® STOMACH DEFENSE"}),e.jsx("button",{className:"ee-menu__btn",role:"menuitem",onClick:()=>{a("typing"),c(!1)},children:"‚å®Ô∏è HACK_TYPING"})]})}),e.jsx(K,{children:l==="stomach"&&e.jsx(ce,{onClose:()=>a(null)})}),e.jsx(K,{children:l==="typing"&&e.jsx(le,{onClose:()=>a(null)})}),e.jsx(K,{children:f&&e.jsxs(x.div,{className:"konami-flash",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},"aria-live":"polite",children:[e.jsx("span",{className:"konami-flash__text",children:"‚¨ÜÔ∏è‚¨ÜÔ∏è‚¨áÔ∏è‚¨áÔ∏è‚¨ÖÔ∏è‚û°Ô∏è‚¨ÖÔ∏è‚û°Ô∏èüÖ±Ô∏èüÖ∞Ô∏è"}),e.jsx("span",{className:"konami-flash__sub",children:"RETRO MODE ACTIVATED"})]})})]})}export{me as default};
