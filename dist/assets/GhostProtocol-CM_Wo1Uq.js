import{a as t,j as a,A as S,m as w}from"./framer-motion-DjJR-6Ks.js";const f=6,E="prokyi_ghost_found";function T(){try{const n=localStorage.getItem(E);return n?new Set(JSON.parse(n)):new Set}catch{return new Set}}function p(n){localStorage.setItem(E,JSON.stringify([...n]))}function L(){const[n,g]=t.useState(!1),[h,l]=t.useState(!1),[s,v]=t.useState(()=>T()),i=t.useRef(null),m=t.useRef(s);m.current=s,t.useEffect(()=>(n?(document.documentElement.classList.add("ghost-active"),l(!0),clearTimeout(i.current),i.current=setTimeout(()=>l(!1),3e3)):document.documentElement.classList.remove("ghost-active"),()=>clearTimeout(i.current)),[n]);const r=t.useCallback(()=>g(o=>!o),[]);return t.useEffect(()=>{const o=e=>{e.target.tagName==="INPUT"||e.target.tagName==="TEXTAREA"||e.target.isContentEditable||(e.key==="g"||e.key==="G")&&!e.ctrlKey&&!e.metaKey&&!e.altKey&&r()};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[r]),t.useEffect(()=>(window.addEventListener("prokyi-ghost-toggle",r),()=>window.removeEventListener("prokyi-ghost-toggle",r)),[r]),t.useEffect(()=>{const o=e=>{const u=e.target.closest(".ghost-text");if(!u||!n)return;const d=u.dataset.ghostId;!d||m.current.has(d)||(u.classList.add("ghost-text--found"),v(y=>{const c=new Set(y);return c.add(d),p(c),c.size>=f&&window.dispatchEvent(new CustomEvent("prokyi-achievement",{detail:"GHOST IN THE SHELL"})),c}))};return document.addEventListener("click",o),()=>document.removeEventListener("click",o)},[n]),t.useEffect(()=>{s.forEach(o=>{const e=document.querySelector(`[data-ghost-id="${o}"]`);e&&e.classList.add("ghost-text--found")})},[s]),t.useEffect(()=>()=>document.documentElement.classList.remove("ghost-active"),[]),a.jsxs(a.Fragment,{children:[a.jsx(S,{children:h&&a.jsx(w.div,{className:"ghost-protocol-banner",initial:{y:-40,opacity:0},animate:{y:0,opacity:1},exit:{y:-40,opacity:0},transition:{duration:.3},"aria-live":"polite",children:"▸ GHOST PROTOCOL INITIATED — UV SCAN ACTIVE"})}),n&&a.jsxs("div",{className:"ghost-protocol-counter",children:[s.size,"/",f," DECODED"]})]})}const k=t.memo(L);export{k as default};
