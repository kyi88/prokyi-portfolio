import{a as t,j as c,A as k,m as b}from"./framer-motion-DjJR-6Ks.js";const l=typeof window<"u"&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,m={bruteforce:{title:"âš  BRUTE FORCE DETECTED",sub:"Abnormal click frequency â€” countermeasures engaged",duration:2500,clickable:!1},idle:{title:"â³ SESSION TIMEOUT",sub:"No activity detected â€” click to re-authenticate",duration:0,clickable:!0},devtools:{title:"ðŸ”“ UNAUTHORIZED ACCESS ATTEMPT",sub:"Developer tools intrusion detected",duration:3e3,clickable:!1}},a=[];function p(){return a}function g(o){a.length>=50&&a.shift(),a.push({type:o,time:new Date().toLocaleTimeString("ja-JP"),ts:Date.now()})}function y(){const[o,d]=t.useState(null),v=t.useRef([]),s=t.useRef(null),f=t.useRef(null),h=t.useRef(!1),w=t.useRef(0),r=t.useCallback(e=>{if(l||Date.now()-w.current<5e3)return;w.current=Date.now(),g(e),d(e);const i=m[e];i.duration>0&&(clearTimeout(f.current),f.current=setTimeout(()=>d(null),i.duration))},[]);t.useEffect(()=>{if(l)return;const e=()=>{const i=Date.now(),n=v.current;for(n.push(i);n.length>0&&i-n[0]>2e3;)n.shift();n.length>=8&&(r("bruteforce"),window.dispatchEvent(new CustomEvent("prokyi-confetti")),n.length=0)};return window.addEventListener("mousedown",e),()=>window.removeEventListener("mousedown",e)},[r]),t.useEffect(()=>{if(l)return;const e=()=>{clearTimeout(s.current),s.current=setTimeout(()=>r("idle"),45e3)},i=["mousemove","keydown","scroll","touchstart"];return i.forEach(n=>window.addEventListener(n,e,{passive:!0})),e(),()=>{clearTimeout(s.current),i.forEach(n=>window.removeEventListener(n,e))}},[r]),t.useEffect(()=>{if(l||h.current)return;h.current=!0;const i=setTimeout(()=>{const n=window.outerWidth-window.innerWidth>200,E=window.outerHeight-window.innerHeight>300;(n||E)&&r("devtools")},3e3);return()=>clearTimeout(i)},[r]);const T=t.useCallback(()=>{var e;o&&((e=m[o])!=null&&e.clickable)&&(d(null),clearTimeout(s.current),s.current=setTimeout(()=>r("idle"),45e3))},[o,r]);t.useEffect(()=>()=>{clearTimeout(f.current),clearTimeout(s.current)},[]);const u=o?m[o]:null;return c.jsx(k,{children:u&&c.jsxs(b.div,{className:`intrusion-overlay${u.clickable?" intrusion-overlay--clickable":""}`,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},onClick:T,role:u.clickable?"dialog":"alert","aria-live":"assertive",children:[c.jsx("div",{className:"intrusion-overlay__scanline"}),c.jsx("div",{className:"intrusion-overlay__border"}),c.jsx("div",{className:"intrusion-overlay__title",children:u.title}),c.jsx("div",{className:"intrusion-overlay__sub",children:u.sub})]})})}const A=t.memo(y);export{A as default,p as getSecurityLog};
